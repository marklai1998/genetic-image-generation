(this["webpackJsonpgenetic-image-generation"]=this["webpackJsonpgenetic-image-generation"]||[]).push([[0],{43:function(t,e,n){"use strict";n.r(e);var r,a,c,o,i=n(0),s=n.n(i),u=n(26),h=n.n(u),f=n(5),l=n(3),b=n.n(l),d=n(7),j=n(4),p=n(6),O=n.p+"static/media/logo.14f0eb6d.svg",m=n.p+"static/media/github-logo.38e30528.svg",g=n(1),v=function(){return Object(g.jsxs)(x,{children:[Object(g.jsx)(w,{src:O,alt:"logo"}),Object(g.jsx)(y,{children:"Genetic Image Generation"}),Object(g.jsx)("a",{href:"https://github.com/marklai1998/genetic-image-generation",children:Object(g.jsx)(k,{src:m,alt:"git-hub-logo"})})]})},x=p.b.header(r||(r=Object(f.a)(["\n  background-color: #242424;\n  height: 50px;\n  flex-shrink: 0;\n  display: flex;\n"]))),w=p.b.img(a||(a=Object(f.a)(["\n  height: 30px;\n  padding: 10px;\n  background-color: #2d3034;\n  color: #e6e6e6;\n"]))),y=p.b.div(c||(c=Object(f.a)(["\n  line-height: 50px;\n  color: #e6e6e6;\n  font-size: 20px;\n  padding-left: 15px;\n  font-weight: bold;\n  width: 100%;\n  overflow: hidden;\n"]))),k=p.b.img(o||(o=Object(f.a)(["\n  height: 30px;\n  padding: 10px;\n  background-color: #2d3034;\n  color: #e6e6e6;\n  transition: 0.5s;\n\n  &:hover {\n    background-color: rgb(53, 53, 53);\n  }\n"]))),M=n(48),C=n(49),S=n(46),R=n(45),I=n(11),E=n(19),P=n(20),D=n(9),F=n(15),A=n(30),z=function(t,e){return new Promise((function(n){var r=e.getContext("2d");if(r){var a=new Image;a.onload=Object(d.a)(b.a.mark((function t(){var c,o,i,s,u;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=a.width,o=a.height,i=e.width,s=e.height,r.clearRect(0,0,i,s),u=Math.min(i/c,s/o),r.drawImage(a,0,0,c*u,o*u),n(u);case 6:case"end":return t.stop()}}),t)}))),a.src=t}}))},G=function(t,e){var n=e.getContext("2d");if(n){var r=e.width,a=e.height;n.clearRect(0,0,r,a),t.polygons.forEach((function(t){var e=Object(A.a)(t.vertices),c=e[0],o=e.slice(1),i=t.color;n.fillStyle="rgba(".concat(255*i[0],", ").concat(255*i[1],", ").concat(255*i[2],", ").concat(i[3],")"),n.beginPath(),n.moveTo(c.x*r,c.y*a),o.forEach((function(t){n.lineTo(t.x*r,t.y*a)})),n.closePath(),n.fill()}))}},H=function(t){var e=t.getContext("2d");return e?e.getImageData(0,0,t.width,t.height).data:new Uint8ClampedArray},J=function(t,e){var n=e.getContext("2d");n&&(n.font="16px Rajdhani",n.fillStyle="white",n.fillText("Generation: ".concat(st),10,16),n.fillText("Fitness: ".concat(t.fitness),10,32))},T=n(32);var W=new function(){return new Worker(n.p+"static/js/worker.33015658.worker.js")},U=T.a(W),V=Object(F.a)("x"),B=Object(F.a)("y"),L=function(){function t(){Object(E.a)(this,t),Object.defineProperty(this,V,{writable:!0,value:0}),Object.defineProperty(this,B,{writable:!0,value:0}),Object(D.a)(this,V)[V]=Math.random(),Object(D.a)(this,B)[B]=Math.random()}return Object(P.a)(t,[{key:"x",get:function(){return Object(D.a)(this,V)[V]},set:function(t){Object(D.a)(this,V)[V]=t<0||t>1?Math.random():t}},{key:"y",get:function(){return Object(D.a)(this,B)[B]},set:function(t){Object(D.a)(this,B)[B]=t<0||t>1?Math.random():t}},{key:"mutate",value:function(t){Math.random()<.25&&(this.x=Math.random()<.5?this.x+Math.random()/t:this.x-Math.random()/t),Math.random()<.25&&(this.y=Math.random()<.5?this.y+Math.random()/t:this.y-Math.random()/t)}}],[{key:"clone",value:function(e){var n=new t;return n.x=e.x,n.y=e.y,n}}]),t}(),q=Object(F.a)("vertices"),K=Object(F.a)("color"),N=function(){function t(e){Object(E.a)(this,t),Object.defineProperty(this,q,{writable:!0,value:[]}),Object.defineProperty(this,K,{writable:!0,value:[0,0,0,0]}),Object(D.a)(this,q)[q]=Object(R.a)(0,e).map((function(){return new L})),Object(D.a)(this,K)[K]=[Math.random(),Math.random(),Math.random(),.15]}return Object(P.a)(t,[{key:"vertices",get:function(){return Object(D.a)(this,q)[q].map((function(t){return L.clone(t)}))},set:function(t){Object(D.a)(this,q)[q]=t}},{key:"color",get:function(){return Object(I.a)(Object(D.a)(this,K)[K])},set:function(t){Object(D.a)(this,K)[K]=t.map((function(t){return t<0||t>1?Math.random():t}))}},{key:"mutate",value:function(t){this.color=this.color.map((function(e){return Math.random()<.25?Math.random()<.5?e+10*Math.random()/t:e-10*Math.random()/t:e})),this.vertices.forEach((function(e){e.mutate(t)}))}}],[{key:"clone",value:function(e){var n=new t(e.vertices.length);return n.color=e.color,n.vertices=e.vertices,n}}]),t}(),Q=function(){function t(){Object(E.a)(this,t),this.fitness=0,this.polygons=[],this.polygons=Object(R.a)(0,t.polyCount).map((function(){return new N(t.verticesCount)}))}return Object(P.a)(t,[{key:"calculateFitness",value:function(){var e=Object(d.a)(b.a.mark((function e(){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(this,t.refChromoCanvas),n=H(t.refChromoCanvas),e.next=4,U(n,t.refImageData);case 4:r=e.sent,this.fitness=r;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"compare",value:function(t){return this.fitness===t.fitness?0:this.fitness>=t.fitness?-1:1}},{key:"mutate",value:function(t){this.polygons.forEach((function(e){e.mutate(t)}))}}]),t}();Q.refImageData=new Uint8ClampedArray,Q.refChromoCanvas=document.createElement("canvas"),Q.imgScale=1,Q.polyCount=0,Q.verticesCount=0;var X,Y,Z,$,_,tt,et,nt,rt,at,ct=n(47),ot=function(t,e){var n=new Q,r=n.polygons.length;return n.polygons=Object(R.a)(0,r).map((function(n,r){var a=Math.random()<.5?t.polygons[r]:e.polygons[r];return N.clone(a)})),n},it=function(){var t=Object(d.a)(b.a.mark((function t(e){var n,r,a,c,o,i,s,u,h,f,l,p;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.length,r=e.sort((function(t,e){return t.compare(e)})),a=Object(ct.a)(Math.ceil(n*(1/3)),r),c=Object(j.a)(a,2),o=c[0],i=c[1],s=Object(ct.a)(Math.floor(.2*o.length),o),u=Object(j.a)(s,2),h=u[0],f=u[1],l=o.length,t.next=7,Promise.all(f.map(function(){var t=Object(d.a)(b.a.mark((function t(e){var n,r,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,Math.random()<.95?(r=Math.round(Math.random()*(l-1)),a=Math.round(Math.random()*(l-1)),n=ot(o[r],o[a])):Math.random()<.95?e.mutate(500*Math.random()):n=new Q,t.next=4,n.calculateFitness();case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 7:return p=t.sent,t.abrupt("return",[].concat(Object(I.a)(h),Object(I.a)(p),Object(I.a)(i.map((function(){return new Q})))));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),st=0,ut=[],ht=!1,ft=function(){var t=Object(d.a)(b.a.mark((function t(e){var n,r,a,c,o,i,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.refImage,r=e.popSize,a=e.polyCount,c=e.vertices,st=0,Q.polyCount=a,Q.verticesCount=c,350,350,Q.refChromoCanvas.width=350,Q.refChromoCanvas.height=350,(o=document.createElement("canvas")).width=350,o.height=350,t.next=13,z(n,o);case 13:return i=t.sent,Q.imgScale=i,Q.refImageData=H(o),o.remove(),s=Object(R.a)(0,r).map((function(){return new Q})),t.next=20,Promise.all(s.map((function(t){return t.calculateFitness()})));case 20:ut=s;case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),lt=function(){var t=Object(d.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ht){t.next=8;break}return st+=1,t.next=4,it(ut);case 4:e=t.sent,ut=e,t.next=0;break;case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),bt=function(){ht=!1},dt=n(31),jt=n.n(dt),pt=n.p+"static/media/mona.c58c8fd8.png",Ot=n(50),mt=Object(i.forwardRef)((function(t,e){var n=t.containerWidth,r=t.containerHeight,a=t.chromo,c=t.maxWidth,o=t.onDraw,s=Object(i.useRef)(null);return Object(i.useEffect)((function(){var t=s.current;if(t){var e=c?Math.min(n,r,c):Math.min(n,r);t.width=e,t.height=e}}),[n,r,c]),Object(i.useEffect)((function(){var t=s.current;t&&a&&(G(a,t),o&&o(a,t))}),[a,o]),Object(g.jsx)("canvas",{ref:s})})),gt=function(){var t=Object(M.a)([]),e=Object(j.a)(t,2),n=e[0],r=e[1],a=Object(i.useState)(!1),c=Object(j.a)(a,2),o=c[0],s=c[1],u=Object(i.useState)(!1),h=Object(j.a)(u,2),f=h[0],l=h[1],p=Object(i.useState)(!1),O=Object(j.a)(p,2),m=O[0],x=O[1],w=Object(i.useState)(pt),y=Object(j.a)(w,2),k=y[0],R=y[1],I=Object(C.a)(),E=Object(j.a)(I,2),P=E[0],D=E[1],F=D.width,A=D.height,H=Object(i.useRef)(null),T=Object(i.useRef)(null),W=Object(i.useRef)(null);Object(i.useEffect)((function(){var t=H.current;if(t){var e=Math.min(F,A,350);t.width=e,t.height=e;var n=T.current;n&&(n.width=e,n.height=e)}}),[F,A]);var U=Object(S.a)(Object(d.a)(b.a.mark((function t(){var e,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m&&r(ut),e=ut[0],n=H.current){t.next=5;break}return t.abrupt("return");case 5:G(e,n),J(e,n);case 7:case"end":return t.stop()}}),t)}))),!1),V=Object(j.a)(U,2),B=V[0],L=V[1],q=Object(i.useCallback)(Object(d.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return bt(),s(!1),B(),t.next=5,ft({refImage:k,popSize:50,vertices:3,polyCount:150});case 5:if(e=T.current){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,z(k,e);case 10:case"end":return t.stop()}}),t)}))),[k,B]);Object(i.useEffect)((function(){q()}),[q]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(vt,{}),Object(g.jsx)(v,{}),Object(g.jsxs)(xt,{ref:P,children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(yt,{color:"#3c4043",onClick:function(){l((function(t){return!t}))},children:f?"View Generation":"View Source Image"}),Object(g.jsxs)(jt.a,{isFlipped:f,flipDirection:"horizontal",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(wt,{ref:H}),Object(g.jsxs)(kt,{children:[Object(g.jsx)(yt,{color:o?"#f50057":"#1565c0",onClick:function(){o?(s(!1),B(),bt()):(s(!0),L(),ht=!0,lt())},children:o?"Pause":"Start"}),Object(g.jsx)(yt,{color:"#f50057",onClick:q,children:"Reset"})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)(wt,{ref:T}),Object(g.jsx)(yt,{color:"#3c4043",onClick:function(){W.current&&W.current.click()},children:"Change Image"}),Object(g.jsx)(Mt,{type:"file",name:"source",accept:"image/*",onChange:function(t){var e=Array.from(t.target.files||[]),n=Object(Ot.a)(e);if(n){var r=new FileReader;r.readAsDataURL(n),r.onload=function(){return R(String(r.result))}}},ref:W})]})]})]}),Object(g.jsxs)(Ct,{children:[Object(g.jsx)(yt,{color:"#3c4043",onClick:function(){x((function(t){return!t}))},children:"View All Chromo"}),Object(g.jsx)(St,{show:m,children:m&&Object(g.jsx)(g.Fragment,{children:n.map((function(t,e){return Object(g.jsxs)(Rt,{children:[Object(g.jsxs)(It,{children:["#",e]}),Object(g.jsx)(mt,{chromo:t,containerHeight:230,containerWidth:230,onDraw:J},e+1)]})}))})})]})]})]})},vt=Object(p.a)(X||(X=Object(f.a)(["\nhtml {\n  height: 100%;\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: 'Rajdhani', Microsoft JhengHei, sans-serif;\n  background-color: #151515;\n  height: 100%;\n}\n\nbutton{\n  font-family: 'Rajdhani', Microsoft JhengHei, sans-serif;\n}\n\n#root {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n"]))),xt=p.b.div(Y||(Y=Object(f.a)(["\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: auto;\n"]))),wt=p.b.canvas(Z||(Z=Object(f.a)(["\n  background-color: #000000;\n"]))),yt=p.b.button($||($=Object(f.a)(["\n  display: block;\n  width: 100%;\n  padding: 5px 10px;\n  background-color: ",";\n  border: 0;\n  color: #fff;\n  position: relative;\n"])),(function(t){return t.color})),kt=p.b.div(_||(_=Object(f.a)(["\n  display: flex;\n"]))),Mt=p.b.input(tt||(tt=Object(f.a)(["\n  display: none;\n"]))),Ct=p.b.div(et||(et=Object(f.a)(["\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n"]))),St=p.b.div(nt||(nt=Object(f.a)(["\n  background-color: #242424;\n  width: 100%;\n\n  height: ","px;\n  overflow-x: auto;\n  overflow-y: hidden;\n  white-space: nowrap;\n"])),(function(t){return t.show?250:0})),Rt=p.b.div(rt||(rt=Object(f.a)(["\n  position: relative;\n  display: inline-block;\n"]))),It=p.b.div(at||(at=Object(f.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  padding: 4px 8px;\n  color: #fff;\n  background-color: #3c4043;\n"])));h.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(gt,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.8f54784e.chunk.js.map