(this["webpackJsonpgenetic-image-generation"]=this["webpackJsonpgenetic-image-generation"]||[]).push([[0],{43:function(e,t,n){"use strict";n.r(t);var r,a,c,o,i=n(0),s=n.n(i),u=n(26),h=n.n(u),f=n(5),l=n(3),b=n.n(l),d=n(7),j=n(4),p=n(6),O=n.p+"static/media/logo.14f0eb6d.svg",m=n.p+"static/media/github-logo.38e30528.svg",g=n(1),v=function(){return Object(g.jsxs)(x,{children:[Object(g.jsx)(w,{src:O,alt:"logo"}),Object(g.jsx)(y,{children:"Genetic Image Generation"}),Object(g.jsx)("a",{href:"https://github.com/marklai1998/genetic-image-generation",children:Object(g.jsx)(k,{src:m,alt:"git-hub-logo"})})]})},x=p.b.header(r||(r=Object(f.a)(["\n  background-color: #242424;\n  height: 50px;\n  flex-shrink: 0;\n  display: flex;\n"]))),w=p.b.img(a||(a=Object(f.a)(["\n  height: 30px;\n  padding: 10px;\n  background-color: #2d3034;\n  color: #e6e6e6;\n"]))),y=p.b.div(c||(c=Object(f.a)(["\n  line-height: 50px;\n  color: #e6e6e6;\n  font-size: 20px;\n  padding-left: 15px;\n  font-weight: bold;\n  width: 100%;\n  overflow: hidden;\n"]))),k=p.b.img(o||(o=Object(f.a)(["\n  height: 30px;\n  padding: 10px;\n  background-color: #2d3034;\n  color: #e6e6e6;\n  transition: 0.5s;\n\n  &:hover {\n    background-color: rgb(53, 53, 53);\n  }\n"]))),M=n(48),C=n(49),S=n(46),R=n(45),E=n(11),I=n(19),P=n(20),F=n(9),D=n(15),A=n(30),z=function(e,t){return new Promise((function(n){var r=t.getContext("2d");if(r){var a=new Image;a.onload=Object(d.a)(b.a.mark((function e(){var c,o,i,s,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=a.width,o=a.height,i=t.width,s=t.height,r.clearRect(0,0,i,s),u=Math.min(i/c,s/o),r.drawImage(a,0,0,c*u,o*u),n(u);case 6:case"end":return e.stop()}}),e)}))),a.src=e}}))},G=function(e,t){var n=t.getContext("2d");if(n){var r=t.width,a=t.height;n.clearRect(0,0,r,a),e.polygons.forEach((function(e){var t=Object(A.a)(e.vertices),c=t[0],o=t.slice(1),i=e.color;n.fillStyle="rgba(".concat(255*i[0],", ").concat(255*i[1],", ").concat(255*i[2],", ").concat(i[3],")"),n.beginPath(),n.moveTo(c.x*r,c.y*a),o.forEach((function(e){n.lineTo(e.x*r,e.y*a)})),n.closePath(),n.fill()}))}},H=function(e){var t=e.getContext("2d");return t?t.getImageData(0,0,e.width,e.height).data:new Uint8ClampedArray},J=function(e,t){e.font="16px Rajdhani",e.fillStyle="white",e.fillText("Generation: ".concat(se),10,16),e.fillText("Fitness: ".concat(t.fitness),10,32)},T=n(32);var W=new function(){return new Worker(n.p+"static/js/worker.33015658.worker.js")},U=T.a(W),V=Object(D.a)("x"),B=Object(D.a)("y"),L=function(){function e(){Object(I.a)(this,e),Object.defineProperty(this,V,{writable:!0,value:0}),Object.defineProperty(this,B,{writable:!0,value:0}),Object(F.a)(this,V)[V]=Math.random(),Object(F.a)(this,B)[B]=Math.random()}return Object(P.a)(e,[{key:"x",get:function(){return Object(F.a)(this,V)[V]},set:function(e){Object(F.a)(this,V)[V]=e<0||e>1?Math.random():e}},{key:"y",get:function(){return Object(F.a)(this,B)[B]},set:function(e){Object(F.a)(this,B)[B]=e<0||e>1?Math.random():e}},{key:"mutate",value:function(e){Math.random()<.5&&(this.x=Math.random()<.5?this.x+Math.random()/e:this.x-Math.random()/e),Math.random()<.5&&(this.y=Math.random()<.5?this.y+Math.random()/e:this.y-Math.random()/e)}}],[{key:"clone",value:function(t){var n=new e;return n.x=t.x,n.y=t.y,n}}]),e}(),q=Object(D.a)("vertices"),K=Object(D.a)("color"),N=function(){function e(t){Object(I.a)(this,e),Object.defineProperty(this,q,{writable:!0,value:[]}),Object.defineProperty(this,K,{writable:!0,value:[0,0,0,0]}),Object(F.a)(this,q)[q]=Object(R.a)(0,t).map((function(){return new L})),Object(F.a)(this,K)[K]=[Math.random(),Math.random(),Math.random(),.15]}return Object(P.a)(e,[{key:"vertices",get:function(){return Object(F.a)(this,q)[q].map((function(e){return L.clone(e)}))},set:function(e){Object(F.a)(this,q)[q]=e}},{key:"color",get:function(){return Object(E.a)(Object(F.a)(this,K)[K])},set:function(e){Object(F.a)(this,K)[K]=e.map((function(e){return e<0||e>1?Math.random():e}))}},{key:"mutate",value:function(e){this.color=this.color.map((function(t){return Math.random()<.25?Math.random()<.5?t+10*Math.random()/e:t-10*Math.random()/e:t})),this.vertices.forEach((function(t){t.mutate(e)}))}}],[{key:"clone",value:function(t){var n=new e(t.vertices.length);return n.color=t.color,n.vertices=t.vertices,n}}]),e}(),Q=function(){function e(){Object(I.a)(this,e),this.fitness=0,this.polygons=[],this.polygons=Object(R.a)(0,e.polyCount).map((function(){return new N(e.verticesCount)}))}return Object(P.a)(e,[{key:"calculateFitness",value:function(){var t=Object(d.a)(b.a.mark((function t(){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return G(this,e.refChromoCanvas),n=H(e.refChromoCanvas),t.next=4,U(n,e.refImageData);case 4:r=t.sent,this.fitness=r;case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"compare",value:function(e){return this.fitness===e.fitness?0:this.fitness>=e.fitness?-1:1}},{key:"mutate",value:function(e){this.polygons.forEach((function(t){t.mutate(e)}))}}]),e}();Q.refImageData=new Uint8ClampedArray,Q.refChromoCanvas=document.createElement("canvas"),Q.imgScale=1,Q.polyCount=0,Q.verticesCount=0;var X,Y,Z,$,_,ee,te,ne,re,ae,ce=n(47),oe=function(e,t){var n=new Q,r=n.polygons.length;return n.polygons=Object(R.a)(0,r).map((function(n,r){var a=Math.random()<.5?e.polygons[r]:t.polygons[r];return N.clone(a)})),n},ie=function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r,a,c,o,i,s,u,h,f,l,p,O;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.length,r=t.sort((function(e,t){return e.compare(t)})),a=Object(ce.a)(Math.ceil(.5*n),r),c=Object(j.a)(a,2),o=c[0],i=c[1],s=Object(ce.a)(Math.floor(.2*o.length),o),u=Object(j.a)(s,2),h=u[0],f=u[1],l=o.length,e.next=7,Promise.all(f.map(function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,Math.random()<.95?(r=Math.round(Math.random()*(l-1)),a=Math.round(Math.random()*(l-1)),n=oe(o[r],o[a])):Math.random()<.95?t.mutate(500*Math.random()):n=new Q,e.next=4,n.calculateFitness();case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return p=e.sent,e.next=10,Promise.all(i.map(Object(d.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Q,e.next=3,t.calculateFitness();case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))));case 10:return O=e.sent,e.abrupt("return",[].concat(Object(E.a)(h),Object(E.a)(p),Object(E.a)(O)));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=0,ue=[],he=function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r,a,c,o,i,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.refImage,r=t.popSize,a=t.polyCount,c=t.vertices,se=0,Q.polyCount=a,Q.verticesCount=c,350,350,Q.refChromoCanvas.width=350,Q.refChromoCanvas.height=350,(o=document.createElement("canvas")).width=350,o.height=350,e.next=13,z(n,o);case 13:return i=e.sent,Q.imgScale=i,Q.refImageData=H(o),o.remove(),s=Object(R.a)(0,r).map((function(){return new Q})),e.next=20,Promise.all(s.map((function(e){return e.calculateFitness()})));case 20:ue=s;case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se+=1,e.next=3,ie(ue);case 3:ue=e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=n(31),be=n.n(le),de=n.p+"static/media/mona.c58c8fd8.png",je=n(50),pe=Object(i.forwardRef)((function(e,t){var n=e.containerWidth,r=e.containerHeight,a=e.chromo,c=e.maxWidth,o=e.onDraw,s=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=s.current;if(e){var t=c?Math.min(n,r,c):Math.min(n,r);e.width=t,e.height=t}}),[n,r,c]),Object(i.useEffect)((function(){var e=s.current;if(e&&a){G(a,e);var t=e.getContext("2d");t&&o&&o(t,a)}}),[a,o]),Object(g.jsx)("canvas",{ref:s})})),Oe=function(){var e=Object(M.a)([]),t=Object(j.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(!1),c=Object(j.a)(a,2),o=c[0],s=c[1],u=Object(i.useState)(!1),h=Object(j.a)(u,2),f=h[0],l=h[1],p=Object(i.useState)(!1),O=Object(j.a)(p,2),m=O[0],x=O[1],w=Object(i.useState)(de),y=Object(j.a)(w,2),k=y[0],R=y[1],E=Object(C.a)(),I=Object(j.a)(E,2),P=I[0],F=I[1],D=F.width,A=F.height,H=Object(i.useRef)(null),T=Object(i.useRef)(null),W=Object(i.useRef)(null);Object(i.useEffect)((function(){var e=H.current;if(e){var t=Math.min(D,A,350);e.width=t,e.height=t;var n=T.current;n&&(n.width=t,n.height=t)}}),[D,A]),Object(i.useEffect)((function(){o&&function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=5;break}return e.next=3,fe();case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[o]);var U=Object(S.a)(Object(d.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m&&r(ue),t=ue[0],n=H.current){e.next=5;break}return e.abrupt("return");case 5:if(G(t,n),a=n.getContext("2d")){e.next=9;break}return e.abrupt("return");case 9:J(a,t);case 10:case"end":return e.stop()}}),e)}))),!1),V=Object(j.a)(U,2),B=V[0],L=V[1],q=Object(i.useCallback)(Object(d.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!1),B(),e.next=4,he({refImage:k,popSize:50,vertices:3,polyCount:150});case 4:if(t=T.current){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,z(k,t);case 9:case"end":return e.stop()}}),e)}))),[k,B]);Object(i.useEffect)((function(){q()}),[q]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(me,{}),Object(g.jsx)(v,{}),Object(g.jsxs)(ge,{ref:P,children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(xe,{color:"#3c4043",onClick:function(){l((function(e){return!e}))},children:f?"View Generation":"View Source Image"}),Object(g.jsxs)(be.a,{isFlipped:f,flipDirection:"horizontal",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(ve,{ref:H}),Object(g.jsxs)(we,{children:[Object(g.jsx)(xe,{color:o?"#f50057":"#1565c0",onClick:function(){o?(s(!1),B()):(s(!0),L())},children:o?"Pause":"Start"}),Object(g.jsx)(xe,{color:"#f50057",onClick:q,children:"Reset"})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)(ve,{ref:T}),Object(g.jsx)(xe,{color:"#3c4043",onClick:function(){W.current&&W.current.click()},children:"Change Image"}),Object(g.jsx)(ye,{type:"file",name:"source",accept:"image/*",onChange:function(e){var t=Array.from(e.target.files||[]),n=Object(je.a)(t);if(n){var r=new FileReader;r.readAsDataURL(n),r.onload=function(){return R(String(r.result))}}},ref:W})]})]})]}),Object(g.jsxs)(ke,{children:[Object(g.jsx)(xe,{color:"#3c4043",onClick:function(){x((function(e){return!e}))},children:"View All Chromo"}),Object(g.jsx)(Me,{show:m,children:m&&Object(g.jsx)(g.Fragment,{children:n.map((function(e,t){return Object(g.jsxs)(Ce,{children:[Object(g.jsxs)(Se,{children:["#",t]}),Object(g.jsx)(pe,{chromo:e,containerHeight:230,containerWidth:230,onDraw:J},t+1)]})}))})})]})]})]})},me=Object(p.a)(X||(X=Object(f.a)(["\nhtml {\n  height: 100%;\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: 'Rajdhani', Microsoft JhengHei, sans-serif;\n  background-color: #151515;\n  height: 100%;\n}\n\nbutton{\n  font-family: 'Rajdhani', Microsoft JhengHei, sans-serif;\n}\n\n#root {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n"]))),ge=p.b.div(Y||(Y=Object(f.a)(["\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: auto;\n"]))),ve=p.b.canvas(Z||(Z=Object(f.a)(["\n  background-color: #000000;\n"]))),xe=p.b.button($||($=Object(f.a)(["\n  display: block;\n  width: 100%;\n  padding: 5px 10px;\n  background-color: ",";\n  border: 0;\n  color: #fff;\n  position: relative;\n"])),(function(e){return e.color})),we=p.b.div(_||(_=Object(f.a)(["\n  display: flex;\n"]))),ye=p.b.input(ee||(ee=Object(f.a)(["\n  display: none;\n"]))),ke=p.b.div(te||(te=Object(f.a)(["\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n"]))),Me=p.b.div(ne||(ne=Object(f.a)(["\n  background-color: #242424;\n  width: 100%;\n\n  height: ","px;\n  overflow-x: auto;\n  overflow-y: hidden;\n  white-space: nowrap;\n"])),(function(e){return e.show?250:0})),Ce=p.b.div(re||(re=Object(f.a)(["\n  position: relative;\n  display: inline-block;\n"]))),Se=p.b.div(ae||(ae=Object(f.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  padding: 4px 8px;\n  color: #fff;\n  background-color: #3c4043;\n"])));h.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(Oe,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.c898aa19.chunk.js.map