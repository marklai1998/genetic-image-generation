(this["webpackJsonpgenetic-image-generation"]=this["webpackJsonpgenetic-image-generation"]||[]).push([[0],{43:function(t,e,n){"use strict";n.r(e);var r,a,c,i,o=n(0),s=n.n(o),u=n(26),h=n.n(u),f=n(6),l=n(3),b=n.n(l),d=n(5),j=n(4),p=n(7),m=n.p+"static/media/logo.14f0eb6d.svg",O=n.p+"static/media/github-logo.38e30528.svg",g=n(1),v=function(){return Object(g.jsxs)(x,{children:[Object(g.jsx)(w,{src:m,alt:"logo"}),Object(g.jsx)(y,{children:"Genetic Image Generation"}),Object(g.jsx)("a",{href:"https://github.com/marklai1998/genetic-image-generation",children:Object(g.jsx)(k,{src:O,alt:"git-hub-logo"})})]})},x=p.b.header(r||(r=Object(f.a)(["\n  background-color: #242424;\n  height: 50px;\n  flex-shrink: 0;\n  display: flex;\n"]))),w=p.b.img(a||(a=Object(f.a)(["\n  height: 30px;\n  padding: 10px;\n  background-color: #2d3034;\n  color: #e6e6e6;\n"]))),y=p.b.div(c||(c=Object(f.a)(["\n  line-height: 50px;\n  color: #e6e6e6;\n  font-size: 20px;\n  padding-left: 15px;\n  font-weight: bold;\n  width: 100%;\n  overflow: hidden;\n"]))),k=p.b.img(i||(i=Object(f.a)(["\n  height: 30px;\n  padding: 10px;\n  background-color: #2d3034;\n  color: #e6e6e6;\n  transition: 0.5s;\n\n  &:hover {\n    background-color: rgb(53, 53, 53);\n  }\n"]))),M=n(48),C=n(49),S=n(46),R=n(45),E=n(11),I=n(19),P=n(20),F=n(9),D=n(15),A=n(30),z=function(t,e){return new Promise((function(n){var r=e.getContext("2d");if(r){var a=new Image;a.onload=Object(d.a)(b.a.mark((function t(){var c,i,o,s,u;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=a.width,i=a.height,o=e.width,s=e.height,r.clearRect(0,0,o,s),u=Math.min(o/c,s/i),r.drawImage(a,0,0,c*u,i*u),n(u);case 6:case"end":return t.stop()}}),t)}))),a.src=t}}))},G=function(t,e){var n=e.getContext("2d");if(n){var r=e.width,a=e.height;n.clearRect(0,0,r,a),t.polygons.forEach((function(t){var e=Object(A.a)(t.vertices),c=e[0],i=e.slice(1),o=t.color;n.fillStyle="rgba(".concat(255*o[0],", ").concat(255*o[1],", ").concat(255*o[2],", ").concat(o[3],")"),n.beginPath(),n.moveTo(c.x*r,c.y*a),i.forEach((function(t){n.lineTo(t.x*r,t.y*a)})),n.closePath(),n.fill()}))}},H=function(t){var e=t.getContext("2d");return e?e.getImageData(0,0,t.width,t.height).data:new Uint8ClampedArray},J=function(t,e){t.font="16px Rajdhani",t.fillStyle="white",t.fillText("Generation: ".concat(ot),10,16),t.fillText("Fitness: ".concat(e.fitness),10,32)},T=n(32);var W=new function(){return new Worker(n.p+"static/js/worker.4be51ca9.worker.js")},U=T.a(W),V=Object(D.a)("x"),B=Object(D.a)("y"),L=function(){function t(){Object(I.a)(this,t),Object.defineProperty(this,V,{writable:!0,value:0}),Object.defineProperty(this,B,{writable:!0,value:0}),Object(F.a)(this,V)[V]=Math.random(),Object(F.a)(this,B)[B]=Math.random()}return Object(P.a)(t,[{key:"x",get:function(){return Object(F.a)(this,V)[V]},set:function(t){Object(F.a)(this,V)[V]=t<0||t>1?Math.random():t}},{key:"y",get:function(){return Object(F.a)(this,B)[B]},set:function(t){Object(F.a)(this,B)[B]=t<0||t>1?Math.random():t}},{key:"mutate",value:function(t){Math.random()<.5&&(this.x=Math.random()<.5?this.x+Math.random()/t:this.x-Math.random()/t),Math.random()<.5&&(this.y=Math.random()<.5?this.y+Math.random()/t:this.y-Math.random()/t)}}],[{key:"clone",value:function(e){var n=new t;return n.x=e.x,n.y=e.y,n}}]),t}(),q=Object(D.a)("vertices"),K=Object(D.a)("color"),N=function(){function t(e){Object(I.a)(this,t),Object.defineProperty(this,q,{writable:!0,value:[]}),Object.defineProperty(this,K,{writable:!0,value:[0,0,0,0]}),Object(F.a)(this,q)[q]=Object(R.a)(0,e).map((function(){return new L})),Object(F.a)(this,K)[K]=[Math.random(),Math.random(),Math.random(),.15]}return Object(P.a)(t,[{key:"vertices",get:function(){return Object(F.a)(this,q)[q].map((function(t){return L.clone(t)}))},set:function(t){Object(F.a)(this,q)[q]=t}},{key:"color",get:function(){return Object(E.a)(Object(F.a)(this,K)[K])},set:function(t){Object(F.a)(this,K)[K]=t.map((function(t){return t<0||t>1?Math.random():t}))}},{key:"mutate",value:function(t){this.color=this.color.map((function(e){return Math.random()<.25?Math.random()<.5?e+10*Math.random()/t:e-10*Math.random()/t:e})),this.vertices.forEach((function(e){e.mutate(t)}))}}],[{key:"clone",value:function(e){var n=new t(e.vertices.length);return n.color=e.color,n.vertices=e.vertices,n}}]),t}(),Q=function(){function t(){Object(I.a)(this,t),this.fitness=0,this.polygons=[],this.polygons=Object(R.a)(0,t.polyCount).map((function(){return new N(t.verticesCount)}))}return Object(P.a)(t,[{key:"calculateFitness",value:function(){var e=Object(d.a)(b.a.mark((function e(){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(this,t.refChromoCanvas),n=H(t.refChromoCanvas),e.next=4,U(n,t.refImageData);case 4:r=e.sent,this.fitness=r;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"compare",value:function(t){return this.fitness===t.fitness?0:this.fitness>=t.fitness?-1:1}},{key:"mutate",value:function(t){this.polygons.forEach((function(e){e.mutate(t)}))}}]),t}();Q.refImageData=new Uint8ClampedArray,Q.refChromoCanvas=document.createElement("canvas"),Q.imgScale=1,Q.polyCount=0,Q.verticesCount=0;var X,Y,Z,$,_,tt,et,nt,rt,at=n(47),ct=function(t,e){var n=new Q,r=n.polygons.length;return n.polygons=Object(R.a)(0,r).map((function(n,r){var a=Math.random()<.5?t.polygons[r]:e.polygons[r];return N.clone(a)})),n},it=function(){var t=Object(d.a)(b.a.mark((function t(e){var n,r,a,c,i,o,s,u,h,f,l,p,m;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.length,r=e.sort((function(t,e){return t.compare(e)})),a=Object(at.a)(Math.ceil(.5*n),r),c=Object(j.a)(a,2),i=c[0],o=c[1],s=Object(at.a)(Math.floor(.2*i.length),i),u=Object(j.a)(s,2),h=u[0],f=u[1],l=i.length,t.next=7,Promise.all(f.map(function(){var t=Object(d.a)(b.a.mark((function t(e){var n,r,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,Math.random()<.95?(r=Math.round(Math.random()*(l-1)),a=Math.round(Math.random()*(l-1)),n=ct(i[r],i[a])):Math.random()<.95?e.mutate(500*Math.random()):n=new Q,t.next=4,n.calculateFitness();case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 7:return p=t.sent,t.next=10,Promise.all(o.map(Object(d.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Q,t.next=3,e.calculateFitness();case 3:return t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})))));case 10:return m=t.sent,t.abrupt("return",[].concat(Object(E.a)(h),Object(E.a)(p),Object(E.a)(m)));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ot=0,st=[],ut=function(){var t=Object(d.a)(b.a.mark((function t(e){var n,r,a,c,i,o,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.refImage,r=e.popSize,a=e.polyCount,c=e.vertices,st=[],ot=0,Q.polyCount=a,Q.verticesCount=c,350,350,Q.refChromoCanvas.width=350,Q.refChromoCanvas.height=350,(i=document.createElement("canvas")).width=350,i.height=350,t.next=14,z(n,i);case 14:return o=t.sent,Q.imgScale=o,Q.refImageData=H(i),i.remove(),s=Object(R.a)(0,r).map((function(){return new Q})),t.next=21,Promise.all(s.map((function(t){return t.calculateFitness()})));case 21:st=s;case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ht=function(){var t=Object(d.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ot+=1,t.next=3,it(st);case 3:st=t.sent;case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ft=n(31),lt=n.n(ft),bt=n.p+"static/media/mona.c58c8fd8.png",dt=n(50),jt=Object(o.forwardRef)((function(t,e){var n=t.containerWidth,r=t.containerHeight,a=t.chromo,c=t.maxWidth,i=t.onDraw,s=Object(o.useRef)(null);return Object(o.useEffect)((function(){var t=s.current;if(t){var e=c?Math.min(n,r,c):Math.min(n,r);t.width=e,t.height=e}}),[n,r,c]),Object(o.useEffect)((function(){var t=s.current;if(t&&a){G(a,t);var e=t.getContext("2d");e&&i&&i(e,a)}}),[a,i]),Object(g.jsx)("canvas",{ref:s})})),pt=function(){var t=Object(M.a)([]),e=Object(j.a)(t,2),n=e[0],r=e[1],a=Object(o.useState)(!1),c=Object(j.a)(a,2),i=c[0],s=c[1],u=Object(o.useState)(!1),h=Object(j.a)(u,2),f=h[0],l=h[1],p=Object(o.useState)(!1),m=Object(j.a)(p,2),O=m[0],x=m[1],w=Object(o.useState)(bt),y=Object(j.a)(w,2),k=y[0],R=y[1],E=Object(C.a)(),I=Object(j.a)(E,2),P=I[0],F=I[1],D=F.width,A=F.height,H=Object(o.useRef)(null),T=Object(o.useRef)(null),W=Object(o.useRef)(null);Object(o.useEffect)((function(){var t=H.current;if(t){var e=Math.min(D,A,350);t.width=e,t.height=e;var n=T.current;n&&(n.width=e,n.height=e)}}),[D,A]),Object(o.useEffect)((function(){i&&function(){var t=Object(d.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=5;break}return t.next=3,ht();case 3:t.next=0;break;case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[i]);var U=Object(S.a)(Object(d.a)(b.a.mark((function t(){var e,n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(O&&r(st),e=st[0],n=H.current){t.next=5;break}return t.abrupt("return");case 5:if(G(e,n),a=n.getContext("2d")){t.next=9;break}return t.abrupt("return");case 9:J(a,e);case 10:case"end":return t.stop()}}),t)}))),!1),V=Object(j.a)(U,2),B=V[0],L=V[1],q=Object(o.useCallback)(Object(d.a)(b.a.mark((function t(){var e,n,a,c,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s(!1),B(),r([]),e=H.current){t.next=6;break}return t.abrupt("return");case 6:if(n=e.width,a=e.height,c=e.getContext("2d")){t.next=10;break}return t.abrupt("return");case 10:return c.clearRect(0,0,n,a),t.next=13,ut({refImage:k,popSize:50,vertices:3,polyCount:150});case 13:if(i=T.current){t.next=16;break}return t.abrupt("return");case 16:return t.next=18,z(k,i);case 18:case"end":return t.stop()}}),t)}))),[k,B,r]);Object(o.useEffect)((function(){q()}),[q]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(mt,{}),Object(g.jsx)(v,{}),Object(g.jsxs)(Ot,{ref:P,children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(vt,{color:"#3c4043",onClick:function(){l((function(t){return!t}))},children:f?"View Generation":"View Source Image"}),Object(g.jsxs)(lt.a,{isFlipped:f,flipDirection:"horizontal",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(gt,{ref:H}),Object(g.jsx)(vt,{color:i?"#f50057":"#1565c0",onClick:function(){i?(s(!1),B()):(s(!0),L())},children:i?"Pause":"Start"})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)(gt,{ref:T}),Object(g.jsx)(vt,{color:"#3c4043",onClick:function(){W.current&&W.current.click()},children:"Change Image"}),Object(g.jsx)(xt,{type:"file",name:"source",accept:"image/*",onChange:function(t){var e=Array.from(t.target.files||[]),n=Object(dt.a)(e);if(n){var r=new FileReader;r.readAsDataURL(n),r.onload=function(){return R(String(r.result))}}},ref:W})]})]})]}),Object(g.jsxs)(wt,{children:[Object(g.jsx)(vt,{color:"#3c4043",onClick:function(){x((function(t){return!t}))},children:"View All Chromo"}),Object(g.jsx)(yt,{show:O,children:O&&Object(g.jsx)(g.Fragment,{children:n.map((function(t,e){return Object(g.jsxs)(kt,{children:[Object(g.jsxs)(Mt,{children:["#",e]}),Object(g.jsx)(jt,{chromo:t,containerHeight:230,containerWidth:230,onDraw:J},e+1)]})}))})})]})]})]})},mt=Object(p.a)(X||(X=Object(f.a)(["\nhtml {\n  height: 100%;\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: 'Rajdhani', Microsoft JhengHei, sans-serif;\n  background-color: #151515;\n  height: 100%;\n}\n\nbutton{\n  font-family: 'Rajdhani', Microsoft JhengHei, sans-serif;\n}\n\n#root {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n"]))),Ot=p.b.div(Y||(Y=Object(f.a)(["\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: auto;\n"]))),gt=p.b.canvas(Z||(Z=Object(f.a)(["\n  background-color: #000000;\n"]))),vt=p.b.button($||($=Object(f.a)(["\n  display: block;\n  width: 100%;\n  padding: 5px 10px;\n  background-color: ",";\n  border: 0;\n  color: #fff;\n  position: relative;\n"])),(function(t){return t.color})),xt=p.b.input(_||(_=Object(f.a)(["\n  display: none;\n"]))),wt=p.b.div(tt||(tt=Object(f.a)(["\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n"]))),yt=p.b.div(et||(et=Object(f.a)(["\n  background-color: #242424;\n  width: 100%;\n\n  height: ","px;\n  overflow-x: auto;\n  overflow-y: hidden;\n  white-space: nowrap;\n"])),(function(t){return t.show?250:0})),kt=p.b.div(nt||(nt=Object(f.a)(["\n  position: relative;\n  display: inline-block;\n"]))),Mt=p.b.div(rt||(rt=Object(f.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  padding: 4px 8px;\n  color: #fff;\n  background-color: #3c4043;\n"])));h.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(pt,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.36e848b4.chunk.js.map